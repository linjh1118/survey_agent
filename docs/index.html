<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survey Agent - è®ºæ–‡ç¼“å­˜æŸ¥çœ‹å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9em;
        }

        .search-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .search-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }

        .search-input:focus {
            border-color: #3498db;
        }

        .paper-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 25px;
        }

        .paper-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .paper-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .paper-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
        }

        .paper-arxiv-id {
            font-family: 'Courier New', monospace;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            display: inline-block;
            margin-bottom: 10px;
        }

        .paper-title {
            font-size: 1.3em;
            font-weight: bold;
            line-height: 1.4;
        }

        .paper-body {
            padding: 20px;
        }

        .paper-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .paper-summary {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            overflow: hidden;
        }

        .summary-content {
            max-height: 200px;
            overflow-y: auto;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .expand-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.9em;
            transition: background 0.3s;
        }

        .expand-btn:hover {
            background: #2980b9;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #7f8c8d;
        }

        .no-results {
            text-align: center;
            padding: 50px;
            color: #7f8c8d;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”¬ Survey Agent</h1>
            <p>è®ºæ–‡ç¼“å­˜æŸ¥çœ‹å™¨ - å¿«é€Ÿæµè§ˆå·²å¤„ç†çš„å­¦æœ¯è®ºæ–‡</p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="total-papers">-</div>
                <div class="stat-label">ç¼“å­˜è®ºæ–‡æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="last-updated">-</div>
                <div class="stat-label">æœ€åæ›´æ–°</div>
            </div>
        </div>

        <div class="search-box">
            <input type="text" class="search-input" id="search" placeholder="ğŸ” æœç´¢è®ºæ–‡æ ‡é¢˜ã€arXiv ID æˆ–å…³é”®è¯...">
        </div>

        <div id="loading" class="loading">
            <p>æ­£åœ¨åŠ è½½è®ºæ–‡æ•°æ®...</p>
        </div>

        <div id="paper-grid" class="paper-grid" style="display: none;"></div>

        <div id="no-results" class="no-results" style="display: none;">
            <h3>ğŸ˜” æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è®ºæ–‡</h3>
            <p>è¯·å°è¯•å…¶ä»–æœç´¢å…³é”®è¯</p>
        </div>

        <div class="footer">
            <p>Â© 2025 Survey Agent | è‡ªåŠ¨ç”Ÿæˆçš„å­¦æœ¯è®ºæ–‡è°ƒç ”å·¥å…·</p>
        </div>
    </div>

    <script>
        let allPapers = [];
        let displayedPapers = [];

        async function loadPapers() {
            try {
                const response = await fetch('./papers_display.json');
                const data = await response.json();
                allPapers = data.papers;
                displayedPapers = [...allPapers];
                
                document.getElementById('total-papers').textContent = allPapers.length;
                document.getElementById('last-updated').textContent = data.last_updated;
                
                displayPapers(displayedPapers);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('paper-grid').style.display = 'grid';
            } catch (error) {
                console.error('Error loading papers:', error);
                document.getElementById('loading').innerHTML = '<p>âŒ åŠ è½½è®ºæ–‡æ•°æ®å¤±è´¥</p>';
            }
        }

        function displayPapers(papers) {
            const grid = document.getElementById('paper-grid');
            const noResults = document.getElementById('no-results');
            
            if (papers.length === 0) {
                grid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }
            
            noResults.style.display = 'none';
            grid.style.display = 'grid';
            
            grid.innerHTML = papers.map(paper => `
                <div class="paper-card">
                    <div class="paper-header">
                        <div class="paper-arxiv-id">arXiv:${paper.arxiv_id}</div>
                        <div class="paper-title">${paper.title}</div>
                    </div>
                    <div class="paper-body">
                        <div class="paper-meta">
                            <span>ğŸ“… ${paper.cached_at}</span>
                            <span>ğŸ¤– ${paper.model_info.provider}</span>
                        </div>
                        <div class="paper-summary">
                            <div class="summary-content" id="summary-${paper.arxiv_id}">
                                ${formatSummary(paper.summary)}
                            </div>
                            <button class="expand-btn" onclick="toggleSummary('${paper.arxiv_id}')">
                                å±•å¼€å®Œæ•´æ‘˜è¦
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function formatSummary(summary) {
            // ç§»é™¤markdownä»£ç å—æ ‡è®°
            let formatted = summary.replace(/```[\s\S]*?```/g, '');
            // å¤„ç†markdownæ ¼å¼
            formatted = formatted
                .replace(/## (.*?)\n/g, '<h3>$1</h3>')
                .replace(/### (.*?)\n/g, '<h4>$1</h4>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            return '<p>' + formatted + '</p>';
        }

        function toggleSummary(arxivId) {
            const summaryElement = document.getElementById(`summary-${arxivId}`);
            const btn = summaryElement.nextElementSibling;
            
            if (summaryElement.style.maxHeight === 'none') {
                summaryElement.style.maxHeight = '200px';
                btn.textContent = 'å±•å¼€å®Œæ•´æ‘˜è¦';
            } else {
                summaryElement.style.maxHeight = 'none';
                btn.textContent = 'æ”¶èµ·æ‘˜è¦';
            }
        }

        function searchPapers() {
            const query = document.getElementById('search').value.toLowerCase().trim();
            
            if (!query) {
                displayedPapers = [...allPapers];
            } else {
                displayedPapers = allPapers.filter(paper => 
                    paper.title.toLowerCase().includes(query) ||
                    paper.arxiv_id.includes(query) ||
                    paper.summary.toLowerCase().includes(query)
                );
            }
            
            displayPapers(displayedPapers);
        }

        document.getElementById('search').addEventListener('input', searchPapers);

        // åŠ è½½é¡µé¢æ—¶è·å–æ•°æ®
        loadPapers();
    </script>
</body>
</html>